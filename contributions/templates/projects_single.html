{% extends 'base.html' %}
{% block content %}
<div class="container">
    <div class="row">
        <div class="col-xs-12">
            {% if user %}
            <h1>Hello {{ user }}!</h1>
            {%else %}
            <h1>Project!</h1>
            <p>Username: {{ owner.username }}, Name: {{ owner.name }}</p>
            <table class="table table-striped">
            	<th>Project #</th>
            	<th>Owner</th>
            	<th>Project Name</th>
            	<th>Commit Count</th>
            		<tr>
            			<td>{{ project.project_number }}</td>
            			<td><a href="/contributors/{{ owner.key.id() }}">{{ project.owner }}</a></td>
            			<td>{{ project.name }}</td>
            			<td>{{ project.commit_count }}</td>
            		</tr>
            </table>
            {% endif %}
        </div>
    </div>
    <div class="row">
        <div class="col-md-3">
            <div class="well well-sm clearfix">
                <h4 class="chart-title">Commits by Day of Week</h4>

                <div id="day-of-week-chart"></div>
            </div>
        </div>
        <div class="col-md-9">
            <div class="well well-sm clearfix">
                <h4 class="chart-title">Commits Over Time</h4>

                <div id="day-chart"></div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script type="application/javascript">
    var projectId = {{ project.key.id() }};
    showLoadingSpinner();

    getCommits(projectId).then(function (data) {

        cf.data.add(data.objects);
        hideLoadingSpinner();
        var dayOfWeekChart = cf.charts.dayOfWeek('#day-of-week-chart');
        dayOfWeekChart.render();
        $(".loading").fadeOut("fast");
        console.log(cf.groups.day.top(Infinity));
        var dayChart = cf.charts.overTime('#day-chart');
        dayChart.render();
    });
</script>
{% endblock %}
